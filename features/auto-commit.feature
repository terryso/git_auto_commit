# language: zh-CN
# 关联故事：stories/git-auto-commit.story.md
功能: Git AI 提交信息生成
  作为一个开发者
  我想要使用 AI 自动生成提交信息
  以便节省时间并确保提交信息的质量

  场景: 基本的提交流程
    假设 当前目录是一个有效的Git仓库
    而且 存在未提交的文件变更
    当 我执行 git-auto-commit 命令
    那么 系统应该分析当前的代码变更
    并且 生成符合规范的提交信息
    并且 等待用户确认
    当 用户确认提交
    那么 系统应该自动执行git commit命令
    并且 显示提交成功的信息

  场景: 在非Git仓库目录执行命令
    假设 当前目录不是Git仓库
    当 我执行 git-auto-commit 命令
    那么 系统应该显示错误信息 "当前目录不是有效的Git仓库"
    并且 以非零状态码退出

  场景: 在没有变更的仓库中执行命令
    假设 当前目录是一个有效的Git仓库
    而且 没有任何未提交的变更
    当 我执行 git-auto-commit 命令
    那么 系统应该显示错误信息 "没有检测到需要提交的变更"
    并且 以非零状态码退出

  场景: 用户取消提交
    假设 当前目录是一个有效的Git仓库
    而且 存在未提交的文件变更
    当 我执行 git-auto-commit 命令
    那么 系统应该分析当前的代码变更
    并且 生成符合规范的提交信息
    并且 等待用户确认
    当 用户取消提交
    那么 系统应该显示 "已取消提交"
    并且 不应该执行git commit命令
    并且 变更应该保持未提交状态

  场景: AI服务不可用时的错误处理
    假设 当前目录是一个有效的Git仓库
    而且 存在未提交的文件变更
    而且 AI服务不可用
    当 我执行 git-auto-commit 命令
    那么 系统应该显示错误信息 "AI服务错误"
    并且 以非零状态码退出

  场景: 使用自动确认模式提交
    假设 当前目录是一个有效的Git仓库
    而且 存在未提交的文件变更
    当 我执行 git-auto-commit --auto-confirm 命令
    那么 系统应该分析当前的代码变更
    并且 生成符合规范的提交信息
    并且 自动执行git commit命令
    并且 显示提交成功的信息
    并且 不应该等待用户确认

  场景: 使用短参数形式的自动确认模式
    假设 当前目录是一个有效的Git仓库
    而且 存在未提交的文件变更
    当 我执行 git-auto-commit -y 命令
    那么 系统应该分析当前的代码变更
    并且 生成符合规范的提交信息
    并且 自动执行git commit命令
    并且 显示提交成功的信息
    并且 不应该等待用户确认

  场景: 自动确认模式下的错误处理
    假设 当前目录是一个有效的Git仓库
    而且 存在未提交的文件变更
    而且 AI服务不可用
    当 我执行 git-auto-commit --auto-confirm 命令
    那么 系统应该显示错误信息 "AI服务错误"
    并且 以非零状态码退出
    并且 不应该执行git commit命令
